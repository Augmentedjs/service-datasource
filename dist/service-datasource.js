!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("service-datasource",[],t):"object"==typeof exports?exports["service-datasource"]=t():e["service-datasource"]=t()}(this,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s=5)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o={};o.DATABASE=Symbol("database"),o.MEMORY=Symbol("memory"),o.SEARCH=Symbol("search"),t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(0),c=(o=r)&&o.__esModule?o:{default:o};t.default=class{constructor(e,t,n){this.connected=!1,this.style=t||c.default.DATABASE,this._client=e||null,this.url=n||"",this._db=null,this._collection=null}getConnection(){return!1}closeConnection(){}insert(e){}remove(e){}update(e){}query(e,t){return null}get collection(){return this._collection}set collection(e){this._collection=e}get client(){return this._client}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=c(n(1)),r=c(n(0));function c(e){return e&&e.__esModule?e:{default:e}}t.default=class extends o.default{constructor(){super(null,r.default.MEMORY,null),this._db={}}getConnection(e,t){return this.connected=!0,t&&(this._collection=t),this.url=e,!0}closeConnection(){this._db&&this.connected&&(this.connected=!1,this._db=null,this._collection=null)}setCollection(e){e&&Augmented.isString(e)&&(this._collection=e,this._db[this._collection]={})}query(e,t){let n={};if(this._collection&&this.connected){let o=e;Augmented.isFunction(e)&&(o=e()),n=this._db[this._collection][o],t&&t(n)}return n}insert(e,t){let n={};if(!this._collection||!this.connected)throw new Error("no collection defined or not connected.");this._db[this._collection][this._collection]=e,n=e,t&&t(da);return n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=c(n(1)),r=c(n(0));function c(e){return e&&e.__esModule?e:{default:e}}t.default=class extends o.default{constructor(e){super(e,r.default.DATABASE,null)}setCollection(e){e&&Augmented.isString(e)&&(this._collection=this._db.collection(e))}getConnection(e,t){this.connected=!1;let n=this;if(this.client&&!this.connected)return this._client.connect(e,(o,c)=>{if(o)throw new Error(o);t&&(n._collection=c.collection(t)),n._db=c,n.url=e,n.connected=!0,n.style=r.default.DATABASE}),!0;throw new Error("No client was passed.")}closeConnection(){this._db&&this.connected&&(this._db.close(),this.connected=!1,this._db=null,this._collection=null)}query(e,t){let n={};if(!this._collection||!this.connected)throw new Error("no collection defined or not connected to db.");{let o=e;Augmented.isFunction(e)&&(o=e()),this._collection.find(o).toArray((e,o)=>{if(e)throw new Error(e);o&&(n=o),t&&t(n)})}return n}insert(e,t){let n={};if(!this._collection||!this.connected)throw new Error("no collection defined or not connected to db.");return Array.isArray(e)?this._collection.insertMany(e,(e,o)=>{if(e)throw new Error(e);o&&(n=o,t&&t(n))}):this._collection.insertOne(e,(e,o)=>{if(e)throw new Error(e);o&&(n=o,t&&t(n))}),n}update(e,t,n){if(!this._collection||!this.connected)throw new Error("no collection defined or not connected to db.");{let o=e;Augmented.isFunction(e)&&(o=e()),this.collection.update(o,t,(e,t)=>{if(e)throw new Error(e)}),n&&n(t)}return t}remove(e,t){if(!this._collection||!this.connected)throw new Error("no collection defined or not connected to db.");{let n=e;Augmented.isFunction(e)&&(n=e()),this.collection.remove(n,(e,n)=>{if(e)throw new Error(e);t&&t()})}return{}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=c(n(1)),r=c(n(0));function c(e){return e&&e.__esModule?e:{default:e}}t.default=class extends o.default{constructor(e){super(e,r.default.DATABASE,null)}getConnection(e,t){this.connected=!1;let n=this;if(!this._client||this.connected)throw new Error("No client was passed.");return this._client.ping((o,c)=>{if(o)throw new Error(o);n._collection=t,n._db=c,n.url=e,n.connected=!0,n.style=r.default.SEARCH}),this.connected}closeConnection(){this._db&&this.connected&&(this.connected=!1,this._db=null,this._collection=null)}query(e,t){return{}}insert(e,t){return{}}update(e,t,n){return t}remove(e,t){return{}}}},function(e,t,n){"use strict";var o=s(n(1)),r=s(n(0)),c=s(n(2)),i=s(n(3)),l=s(n(4)),u=s(n(6));function s(e){return e&&e.__esModule?e:{default:e}}e.exports.DataSource=o.default,e.exports.DATASOURCE_STYLE=r.default,e.exports.MemoryDataSource=c.default,e.exports.MongoDataSource=i.default,e.exports.SOLRDataSource=l.default,e.exports.DataSourceFactory=u.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(2)),r=i(n(3)),c=i(n(4));function i(e){return e&&e.__esModule?e:{default:e}}class l{constructor(){}static getDatasource(e,t){return e===l.Type.MONGODB?new r.default(t):e===l.Type.SOLR?new c.default(t):e===l.Type.MEMORY?new o.default:null}}l.Type={},l.Type.MEMORY=Symbol("memory"),l.Type.MONGODB=Symbol("mongodb"),l.Type.SOLR=Symbol("solr"),t.default=l}])});
//# sourceMappingURL=service-datasource.js.map